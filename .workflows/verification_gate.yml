version: "2.0"
name: "Verification Gate"

enforcement_policy:
  mode: STRICT
  on_gate_failure: ROLLBACK_TASK

gates:
  - id: security_threshold
    check: "python3 meta_architect/scripts/project_health_check.py --min-score 90"
    severity: CRITICAL
    
  - id: code_quality
    check: "pnpm verify"
    severity: HIGH

  - id: infrastructure_check
    check: "python3 meta_architect/scripts/infra_validator.py"
    severity: CRITICAL

  - id: identity_lock_compliance
    check: "python3 meta_architect/scripts/graph_query.py --action verify_locks"
    severity: CRITICAL

steps:
  - id: run_verification_suite
    action: parallel_exec
    gates: ["security_threshold", "code_quality", "infrastructure_check", "identity_lock_compliance"]
