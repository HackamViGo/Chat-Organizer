# üèóÔ∏è EXTENSION_BUILD_PIPELINE.md - –ü—Ä–æ—Ü–µ—Å –Ω–∞ –∏–∑–≥—Ä–∞–∂–¥–∞–Ω–µ

–¢–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å–≤–∞ –∂–∏–∑–Ω–µ–Ω–∏—è —Ü–∏–∫—ä–ª –Ω–∞ –±–∏–ª–¥–∞ –Ω–∞ Chrome Extension-–∞, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ **Vite** –∏ **CRXJS**, –∫–∞–∫—Ç–æ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ—Ç–æ –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–∏—Ç–µ —Ä–µ—Å—É—Ä—Å–∏.

---

## üõ†Ô∏è Build Pipeline (Vite + CRXJS)

–ü—Ä–æ—Ü–µ—Å—ä—Ç –Ω–∞ –∏–∑–≥—Ä–∞–∂–¥–∞–Ω–µ –µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω —á—Ä–µ–∑ `apps/extension/vite.config.ts` –∏ —Å–ª–µ–¥–≤–∞ —Ç–µ–∑–∏ —Å—Ç—ä–ø–∫–∏:

1.  **Environment Loading**: Vite –∑–∞—Ä–µ–∂–¥–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏—Ç–µ –æ—Ç `.env` —Ñ–∞–π–ª–æ–≤–µ—Ç–µ (–Ω–∞–ø—Ä. `VITE_DASHBOARD_URL`).
2.  **Manifest Transformation**: 
    - –°–∫—Ä–∏–ø—Ç—ä—Ç —á–µ—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è `manifest.json`.
    - –ó–∞–º–µ–Ω—è –ø–ª–µ–π—Å—Ö–æ–ª–¥—ä—Ä–∞ `__DASHBOARD_URL__` —Å —Ä–µ–∞–ª–Ω–∏—è URL –Ω–∞ —Ç–∞–±–ª–æ—Ç–æ.
    - CRXJS –∞–Ω–∞–ª–∏–∑–∏—Ä–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞, –∑–∞ –¥–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞ –≤—Å–∏—á–∫–∏ –≤—Ö–æ–¥–Ω–∏ —Ç–æ—á–∫–∏ (Background, Content Scripts, Popup).
3.  **Compilation & Bundling**:
    - **TypeScript**: –ö–æ–¥—ä—Ç —Å–µ –∫–æ–º–ø–∏–ª–∏—Ä–∞ –æ—Ç `src/` –∫—ä–º ESM –º–æ–¥—É–ª–∏.
    - **Tree Shaking**: Vite –ø—Ä–µ–º–∞—Ö–≤–∞ –Ω–µ–∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—è –∫–æ–¥.
    - **Production Optimization**: –ü—Ä–∏ `mode === 'production'` —Å–µ –ø—Ä–µ–º–∞—Ö–≤–∞—Ç –≤—Å–∏—á–∫–∏ `console.log` –∏ `debugger` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
4.  **Security Hardening (stripDevCSP)**:
    - –°–ª–µ–¥ –∑–∞–≤—ä—Ä—à–≤–∞–Ω–µ –Ω–∞ –±–∏–ª–¥–∞, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω –ø–ª—ä–≥–∏–Ω —Å–∫–∞–Ω–∏—Ä–∞ `dist/manifest.json`.
    - –ü—Ä–µ–º–∞—Ö–≤–∞ `localhost` –∏ `127.0.0.1` –æ—Ç `content_security_policy` –∑–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –≤ –ø—Ä–æ–¥—É–∫—Ü–∏—è.

---

## üìÇ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–∏ —Ä–µ—Å—É—Ä—Å–∏

–°—Ç–∞—Ç–∏—á–Ω–∏—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ (–∏–∫–æ–Ω–∏, –∏–Ω–∂–µ–∫—Ü–∏–æ–Ω–Ω–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤–µ) —Å–µ —É–ø—Ä–∞–≤–ª—è–≤–∞—Ç –ø–æ —Å–ª–µ–¥–Ω–∏—è –Ω–∞—á–∏–Ω:

### 1. –ò–∫–æ–Ω–∏ –∏ –∞–∫—Ç–∏–≤–∏
- –ù–∞–º–∏—Ä–∞—Ç —Å–µ –≤ `src/icons/`.
- –†–µ—Ñ–µ—Ä–∏—Ä–∞—Ç —Å–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞:
  ```json
  "icons": {
    "128": "src/icons/icon128.png"
  }
  ```
- Vite/CRXJS –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–∏ –∫–æ–ø–∏—Ä–∞ –≤ `dist/assets/` –∏ –æ–±–Ω–æ–≤—è–≤–∞ –ø—ä—Ç–∏—â–∞—Ç–∞ –≤ –∫—Ä–∞–π–Ω–∏—è –º–∞–Ω–∏—Ñ–µ—Å—Ç.

### 2. Web Accessible Resources
- –†–µ—Å—É—Ä—Å–∏, –∫–æ–∏—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–∞—Ç –¥–æ—Å—Ç—ä–ø–Ω–∏ –æ—Ç —É–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü–∏—Ç–µ (–Ω–∞–ø—Ä. –∑–∞ Gemini), —Å–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞—Ç –≤ —Å–µ–∫—Ü–∏—è—Ç–∞ `web_accessible_resources`.
- –¢–æ–≤–∞ –≤–∫–ª—é—á–≤–∞ –∏–∫–æ–Ω–∏—Ç–µ –∑–∞ UI –±—É—Ç–æ–Ω–∏—Ç–µ, –∫–æ–∏—Ç–æ —Å–µ –∏–Ω–∂–µ–∫—Ç–∏—Ä–∞—Ç –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ AI —á–∞—Ç–æ–≤–µ—Ç–µ.

### 3. Tailwind CSS & Assets
- CSS —Å–µ –∫–æ–º–ø–∏–ª–∏—Ä–∞ —á—Ä–µ–∑ PostCSS –∏ Tailwind, –∫–∞—Ç–æ —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω –±–∏–ª–¥ —Å–∞–º–æ —Å –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—Ç–µ –∫–ª–∞—Å–æ–≤–µ.
- –î–∏—Ä–µ–∫—Ç–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç–∏ –Ω–∞ –∞–∫—Ç–∏–≤–∏ –≤ —á–∏—Å—Ç JS/TS –∫–æ–¥ —Å–µ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç –æ—Ç Vite asset pipeline.

---

## üöÄ –ö–æ–º–∞–Ω–¥–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ

| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –†–µ–∑—É–ª—Ç–∞—Ç |
| :--- | :--- | :--- |
| `pnpm dev` | –°—Ç–∞—Ä—Ç–∏—Ä–∞ Vite HMR —Å—ä—Ä–≤—ä—Ä | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏–µ—Ç–æ –≤ Chrome –ø—Ä–∏ –ø—Ä–æ–º—è–Ω–∞. |
| `pnpm build` | –ì–µ–Ω–µ—Ä–∏—Ä–∞ Production –±–∏–ª–¥ | –ü—Ä–µ—á–∏—Å—Ç–µ–Ω `dist/` –ø–∞–∫–µ—Ç, –≥–æ—Ç–æ–≤ –∑–∞ –∫–∞—á–≤–∞–Ω–µ –≤ Web Store. |
| `pnpm type-check` | –í–∞–ª–∏–¥–∏—Ä–∞ TypeScript | –ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞ –ª–∏–ø—Å–∞ –Ω–∞ —Ç–∏–ø–æ–≤–∏ –≥—Ä–µ—à–∫–∏ –ø—Ä–µ–¥–∏ –±–∏–ª–¥. |

---

> [!IMPORTANT]
> **–ù–∏–∫–æ–≥–∞** –Ω–µ –ø—Ä–æ–º–µ–Ω—è–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ `dist/manifest.json`. –í—Å–∏—á–∫–∏ –ø—Ä–æ–º–µ–Ω–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –ø—Ä–∞–≤—è—Ç –≤ –∫–æ—Ä–µ–Ω–∞ –Ω–∞ `apps/extension/manifest.json` –∏–ª–∏ —á—Ä–µ–∑ `vite.config.ts`.
